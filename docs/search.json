[
  {
    "objectID": "cv/index.html",
    "href": "cv/index.html",
    "title": "About me",
    "section": "",
    "text": "You can download my CV here\nI am currently a researcher at INRAE within the EcoSys research unit where I focus on building eco-evolutionary models of the soil fauna under contamination stress.\nI am a broadly trained behavioral ecologist who uses a combination of empirical, theoretical and statistical approaches to understand how behavioral variation responds to environmental cues and under which conditions such variation impact higher order processes at the population and community levels. A primary interest of my research program is to use theoretical foundations in the field of animal personality to understand the processes by which individuals cope with the increasing pressures resulting from human activities.\nAfter obtaining my Master’s degree in Environmental Sciences at the École Nationale Supérieure Agronomique de Toulouse in France, I set sail for McGill University in Montréal, Canada where I studied how behavioral variation is impacted by insecticide exposure in jumping spiders during my PhD.\nI held several postdoctoral position previously, which fed my broad interests in evolutionary ecology. Past projects included determining the role of the genetics and environmental sources of variation that shape the integration between phenotypic traits (collab. NDSU, UC Davis) and understanding the role of variation in animal movement in ecological processes (collab. SBiK-F, Marburg University, LMU Munich)."
  },
  {
    "objectID": "blog/index.html",
    "href": "blog/index.html",
    "title": "Behavioral and Evolutionary Ecotoxicology Blog",
    "section": "",
    "text": "This blog is an opportunity for me to explore these different classes of models in the open and hopefully provide some useful tools to the research community. I’ll also post about job opportunities and ongoing projects."
  },
  {
    "objectID": "blog/index.html#whats-on-this-blog",
    "href": "blog/index.html#whats-on-this-blog",
    "title": "Behavioral and Evolutionary Ecotoxicology Blog",
    "section": "",
    "text": "This blog is an opportunity for me to explore these different classes of models in the open and hopefully provide some useful tools to the research community. I’ll also post about job opportunities and ongoing projects."
  },
  {
    "objectID": "blog/2023/job-offer-ofb/index.html",
    "href": "blog/2023/job-offer-ofb/index.html",
    "title": "Postdoctoral Position in Ecotoxicological Modeling",
    "section": "",
    "text": "We are recruiting a Postdoctoral Researcher in Ecotoxicology to work on models of pesticide fate and their impact on biodiversity in vineyard landscapes. The position is a 24-month fixed-term contract with an expected start date of April 1, 2024 with a joint partnership between two INRAE teams (EcoSys and Lisah) and the French Biodiversity Agency (OFB). You may find the full job description here (French version)."
  },
  {
    "objectID": "blog/2023/job-offer-ofb/index.html#job-description",
    "href": "blog/2023/job-offer-ofb/index.html#job-description",
    "title": "Postdoctoral Position in Ecotoxicological Modeling",
    "section": "Job Description",
    "text": "Job Description\nA major limitation of current risk assessment for pesticide products is its reliance on a substance-by-substance assessment while neglecting the risk posed by pesticide mixtures. A further complication is that emission sources and contamination routes may accumulate at the landscape scale through successive applications within and across years. To improve on current environmental risk assessment, reference scenarios of biodiversity exposure at the landscape scale are needed. Spatially-explicit models are powerful tools for linking pesticide fate in the environment to species or groups of species that are most at risk in a given landscape context according to their ecological characteristics.Models for pesticide fate in vineyard agroecosystems are under active development at INRAE and allow to simulate the temporal and spatial variation in pesticide concentration in the air, soil and surface water within heterogeneous farmed catchment considering main landscape elements (farmed plot, hydrographic network, some field margins). The aim of this position is to mobilize these tools to determine how pesticides spread in typical vineyard landscapes when accounting for agricultural practices and landscape configuration. These scenarios will be crossed with agent-based models accounting for how different functional groups of organisms (e.g., detritivores, herbivores, insectivores and pollinators) disperse and move in the landscape as exampled in ALMaSS approaches (Animal, Landscape and Man Simulation System)."
  },
  {
    "objectID": "blog/2023/job-offer-ofb/index.html#working-conditions",
    "href": "blog/2023/job-offer-ofb/index.html#working-conditions",
    "title": "Postdoctoral Position in Ecotoxicological Modeling",
    "section": "Working conditions",
    "text": "Working conditions\nYou will be supervised by Carole Bedos and I within UMR EcoSys, with frequent interactions and short-term missions with UMR Lisah."
  },
  {
    "objectID": "blog/2023/job-offer-ofb/index.html#application",
    "href": "blog/2023/job-offer-ofb/index.html#application",
    "title": "Postdoctoral Position in Ecotoxicological Modeling",
    "section": "Application",
    "text": "Application\nDo not hesitate to reach out to us for any questions! Y Please submit your CV and cover letter by January 31, 2024 through the OFB Portal."
  },
  {
    "objectID": "projects/index.html",
    "href": "projects/index.html",
    "title": "Projects",
    "section": "",
    "text": "Soil functions are under threat due to the generalized used of pesticides in agriculture. These functions are underpinned by a complex network of interactions between soil organisms. In addition, soil organisms are frequently exposed to a cocktail of pesticide molecules rather than a unique compound.\n\n\n\nUnderstanding how pesticides affect these organisms therefore requires studying how complex trophic interactions (predation, competition, mutualism) may be reshaped in presence of pesticide mixtures. To do so, new experimental approaches are needed in order allowing to evaluate pesticide bioaccumulation in soil communities and to measure its effects on species interactions. The EPIC project (Effets des Pesticides sur les Interaction interspécifiques au sein d’une Chaîne trophique simplifiée) aims to: (1) Establish new protocols for comparing pesticide bioaccumulation in mono- vs. multi-species mesocosms, (2) Determine the direct and indirect effects of pesticide mixtures on soil organisms and (3) Generate a mechanistic model of species interactions in response to pesticide stress.\nStudents: Perrine Legrand\nCollaborators: Colette Bertrand (EcoSys) (co-PI), Juliette Faburé (EcoSys), Sophie Joimel (EcoSys), Sylvie Nélieu (EcoSys)\nFunders: INRAE - Département AgroEcoSystemes\nFunding Period: 2023 – 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\nSoil biodiversity is an important reservoir of ecosystem services and is threatened by the wide-scale use of pesticides. Evolution plays a central role in how populations persist because ecological change and evolutionary processes interact in eco-evolutionary feedbacks. These feedbacks can decrease extinction risk by allowing rapid adaptation to environmental stressors but depend on the population density and its genetic makeup.\n\n\n\nDespite evidence that soil fauna can adapt to pesticide exposure, key questions on the speed at which adaptation occurs and the costs for ecosystem functions remain unanswered. EEWORM (Eco-Evolutionary dynamics in earthWORMs exposed to pesticide mixtures) will investigate eco-evolutionary dynamics in populations of the earthworm Aporrectodea caliginosa, a major soil engineer in agricultural systems, exposed to a pesticide mixture representative of French agricultural soils. Our specific aims are to (1) Test whether a pesticide mixture affects life-history trait variation – a required condition for evolution to occur, (2) Estimate the relative influence of selective pressures vs. transgenerational plasticity induced by a pesticide mixture and (3) Generate an individual-based model accounting for eco-evolutionary dynamics in agricultural soils and derive their consequences for soil functions.\nStudents: Lisa Gollot\nCollaborators: Juliette Faburé (EcoSys), Sylvie Nélieu (EcoSys), Rémy Beaudouin (INERIS), Jérôme Mathieu (iEES), Lise Dupont (iEES)\nFunders: Agence Nationale pour la Recherche (ANR)\nFunding Period: 2024 – 2027"
  },
  {
    "objectID": "projects/index.html#funded-projects",
    "href": "projects/index.html#funded-projects",
    "title": "Projects",
    "section": "",
    "text": "Soil functions are under threat due to the generalized used of pesticides in agriculture. These functions are underpinned by a complex network of interactions between soil organisms. In addition, soil organisms are frequently exposed to a cocktail of pesticide molecules rather than a unique compound.\n\n\n\nUnderstanding how pesticides affect these organisms therefore requires studying how complex trophic interactions (predation, competition, mutualism) may be reshaped in presence of pesticide mixtures. To do so, new experimental approaches are needed in order allowing to evaluate pesticide bioaccumulation in soil communities and to measure its effects on species interactions. The EPIC project (Effets des Pesticides sur les Interaction interspécifiques au sein d’une Chaîne trophique simplifiée) aims to: (1) Establish new protocols for comparing pesticide bioaccumulation in mono- vs. multi-species mesocosms, (2) Determine the direct and indirect effects of pesticide mixtures on soil organisms and (3) Generate a mechanistic model of species interactions in response to pesticide stress.\nStudents: Perrine Legrand\nCollaborators: Colette Bertrand (EcoSys) (co-PI), Juliette Faburé (EcoSys), Sophie Joimel (EcoSys), Sylvie Nélieu (EcoSys)\nFunders: INRAE - Département AgroEcoSystemes\nFunding Period: 2023 – 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\nSoil biodiversity is an important reservoir of ecosystem services and is threatened by the wide-scale use of pesticides. Evolution plays a central role in how populations persist because ecological change and evolutionary processes interact in eco-evolutionary feedbacks. These feedbacks can decrease extinction risk by allowing rapid adaptation to environmental stressors but depend on the population density and its genetic makeup.\n\n\n\nDespite evidence that soil fauna can adapt to pesticide exposure, key questions on the speed at which adaptation occurs and the costs for ecosystem functions remain unanswered. EEWORM (Eco-Evolutionary dynamics in earthWORMs exposed to pesticide mixtures) will investigate eco-evolutionary dynamics in populations of the earthworm Aporrectodea caliginosa, a major soil engineer in agricultural systems, exposed to a pesticide mixture representative of French agricultural soils. Our specific aims are to (1) Test whether a pesticide mixture affects life-history trait variation – a required condition for evolution to occur, (2) Estimate the relative influence of selective pressures vs. transgenerational plasticity induced by a pesticide mixture and (3) Generate an individual-based model accounting for eco-evolutionary dynamics in agricultural soils and derive their consequences for soil functions.\nStudents: Lisa Gollot\nCollaborators: Juliette Faburé (EcoSys), Sylvie Nélieu (EcoSys), Rémy Beaudouin (INERIS), Jérôme Mathieu (iEES), Lise Dupont (iEES)\nFunders: Agence Nationale pour la Recherche (ANR)\nFunding Period: 2024 – 2027"
  },
  {
    "objectID": "projects/index.html#other-projects-and-collaborations",
    "href": "projects/index.html#other-projects-and-collaborations",
    "title": "Projects",
    "section": "Other projects and collaborations",
    "text": "Other projects and collaborations\n\nMeasuring the effects of selection using ecotoxicological assays\n\n\n\n\n\n\n\n\n\nEvolutionary effects are frequently unaccounted for in ecotoxicological studies. As a result, we have a poor understanding on how fast wild population may adapt and at what costs on their growth and reproduction. Quantitative genetic approaches allow to determine the strength and shape of selection acting on phenotypes via the estimation of selection gradients.\n\n\n\nYet, these approaches are rarely used in ecotoxicological assays due to the difficulty of measuring individual fitness in ecotoxicological assays. Using historical data on nematode adaptation to Uranium exposure, we aim to better understand how contaminant exposure may alter evolutionary trajectories.\nCollaborators: Rémy Beaudouin (INERIS), Benoit Goussen (IBACON)\n\n\n\nBehavioral ecotoxicology of carabid beetles in agroecosystems\n\n\n\n\n\n\n\n\n\nCarabid beetles activity\n\n\n\n\nAlthough effects on growth, reproduction and survival are the most commonly evaluated traits in ecotoxicology, pesticides’ impact on wildlife is not limited to these endpoints alone. By acting on neuro-endocrine systems, pesticides can also alter how individuals perceive their environment and deeply alter their physiology or behavior.\n\n\n\nUsing automated-tracking technology, I aim to build better mechanistic models accounting for the effects of pesticides on behavior using a generalist carabid predator as a model system.\nCollaborators: Colette Bertrand (EcoSys)\n\n\n\nSpatially-explicit modeling of pesticide fate\nA major limitation of current risk assessment for pesticide products is its reliance on a substance-by-substance assessment while neglecting the risk posed by pesticide mixtures. A further complication is that pesticides are typically applied at the landscape scale and successively within and across years. To improve on current environmental risk assessment, new exposure modelling approaches are needed that can better account for the fate of pesticides at the landscape scale and the likelihood of exposure given the ecological characteristics of each species (modes of exposure, dispersal, mobility between different habitats). Spatially-explicit models are powerful tools for achieving this vision as they can help identifying landscape features that are more likely to accumulate pesticide residues and can help infer species or groups of species that are most at risk in a given landscape context according to their ecological characteristics. The aim of this project is to determine how pesticides spread in typical vineyard landscapes accounting for how different the exposure risk for functional groups of organisms (e.g., detritivores, herbivores, insectivores…). We will soon hire a postdoctoral researcher to collaborate with us on these topics.\nCollaborators: Cécile Dagès (LISAH), Marc Votlz (LISAH), Carole Bedos (EcoSys), Pierre Benoit (EcoSys), Colette Bertrand (EcoSys), Olivier Crouzet (OFB), Pierre-François Staub (OFB)\nFunders: Horizon Europe - European Partnership for the Assessment of Risks from Chemicals(PARC) - WP6.4.4: Quantify effects of PPP and other stressors through landscape risk assessment informing on environmental impacts\nFunding Period: 2024 – 2026"
  },
  {
    "objectID": "research/current-research/index.html",
    "href": "research/current-research/index.html",
    "title": "Current Research",
    "section": "",
    "text": "As a newly-recruited researcher at INRAE, I aim to model the response of soil fauna to various anthropogenic contaminants with a strong emphasis on pesticide mixtures in agroecosystems.\n\nEco-evolutionary dynamics in soil arthropods exposed to pesticide mixtures\nCurrent risk assessment protocols rely heavily on the assumption that ecotoxicological parameters are fixed at the species level. However, individual differences in critical endpoints and in sensitivity to exposure exist and can influence evolutionary responses. Evidence for altered evolutionary trajectories mostly comes from aquatic systems and studies on model organisms. However, we have much less information in terrestrial systems. The results of such evolutionary processes and their feedbacks on ecosystem services such as carbon recycling represent a major gap in our knowledge. By merging current approaches for bioenergetic modeling for pesticide effects with evolutionary theory, I hope to provide insights on a pressing question regarding the risk assessment of pesticides: How fast can soil organisms adapt to pesticide exposure and at what costs for soil functions?\nProjects: EEWORM\n\n\n\nDirect and indirect effects of pesticides in soil trophic networks\nSoil functions are sustained by a complex network of organisms and biological interactions. Understanding the effects of pesticide use on soil biodiversity requires taking into account the different modalities by which organisms are exposed (contact with soil, ingestion of soil particle or contaminated prey) but also determining the consequences of exposure on the stability of trophic network. This means that testing the consequences of pesticide exposure on soil organisms should emphasize testing procedures with interacting communities of organisms rather than relying on a one-species-at-a-time approach. I aim to explore these issues by comparing bioaccumulation of pesticides in simplified soil trophic networks using a combination of predator (carabid bettles) and detritivores (earthworm, enchytraeids, collembola) species.\nProjects: EPIC\n\n\n\nBehavioral ecotoxicology of soil invertebrates\nThe rise of behavioral ecotoxicology as a discipline has shown that the effects of contaminants on organisms’ behaviors are ubiquitous across terrestrial and aquatic ecosystems. Many contaminants act on the nervous system and can reshape how individuals perceive their environment. This means that classical ecotoxicological assays are limited as they tend to focus on growth and reproduction while ignoring subtle effects on social interactions, predator avoidance or feeding strategies. A further complication is the current integration of so-called “animal personalities” within ecotoxicological assays. Simply put, there is tremendous variation in individual responses to the same pesticide exposure as shown in several studies, including in my own research. This means that extracting population averages for key traits (growth, reproduction, no effect concentrations) may result in predictions that poorly reflect how populations cope with contaminants, especially when taking into account evolutionary effects. By merging behavioral endpoints with current theory on the modeling of contaminant effects on organisms, I hope to provide better tools to understand the long-term effects of contaminants on soil organisms and their ecological functions.\n\n\n\n\nModel organisms\n\nApporectodea caliginosa\n\n\n\n\n\n\n\n\n\nA. caliginosa is an endogeic earthworm common in agroecosystem. They are good models for understanding the effects of pesticide use on soils due to their burrowing behaviors and their key role in organic matter decomposition and soil structuration.\n\n\n\n\n\nPoecilus cupreus\n\n\n\n\n\n\n\n\n\nP. cupreus is carabid bettle and an important generalist predator in agroecosystem. It feeds on aphids but also on many soil arthropods, including earthworms.\n\n\n\n\n\nEnchytraeus albidus\n\n\n\n\n\n\n\n\n\nE. albidus is a small annelid worm common in coastal sand dunes. They contribute to soil organic matter decomposition and soil structuration through their burrowing behaviors."
  },
  {
    "objectID": "research/past-research/index.html",
    "href": "research/past-research/index.html",
    "title": "Past Research",
    "section": "",
    "text": "Effects of Contaminants on Behavioral Variation\nDuring my PhD, I examined behavioral syndrome structure and personality variation in regards to development, sex differences, and effects of human disturbances (e.g. pesticide application) on syndromes and personalities. I showed evidence for changes in behavioral correlations between jumping spider populations from an insecticide-exposed and insecticide-free orchard (Ethology 2014) and that direct exposure to a sublethal dose of organophosphate can have a profound effect on personality differences related to activity and prey capture (Functional Ecology 2015). Finally, I provided a conceptual framework by which effects of contaminant on behavioral variation in wildlife can be better understood (Animal Behavior 2014).\n\n\nPhenotypic Integration among Behavior, Physiology and Life-History Traits\nAs a postdoctoral researcher at NDSU, I focused on how strongly behavior correlates with other trait categories such as metabolic rate (Animal Behavior 2015) or animal constructions (J. Evol. Biol. 2018). Using meta-analyses, I showed that behavioral traits are heritable (J. Heredity 2019) but fail to conform to predictions of a “slow-fast” pace-of-life axis (Behav. Ecol. Sociobiol. 2018). I also showed that environmental factors such as diet quality have the potential to profoundly reshape the strength and direction of correlations between behaviors and life-history (Behav. Ecol. 2017; Anim. Behav. 2019)\n\n\nQuantitative Genetics and Evolutionary Constraints of Behavioral Syndromes\nWith collaborators Ned Dochtermann (NDSU) and Ann Hedrick (UC Davis), we investigated how behavioral correlations arise and are maintained in Western Field crickets. We showed that genetic variation in behavior is strongly aligned among isolated populations (Proc. B) and even within different species (J. Evol. Biol.).\n\n\nMovement Ecology and Species Interactions\nSince 2020, I have initiated collaborations with movement ecologists to better understand how individual differences in activity are expressed under natural conditions. These collaborations have shown a high degree of individual differences in the predictability of brown bears (J. Animal Ecol. 2021) and in how ungulate negotiate fence crossing in human-altered landscapes (J. Animal Ecol. 2023). I was also involved with the Nature 4.0 project as a postdoctoral researcher at the Senckenberg Institute. There, I focused on methods for classifying daily activity in bats and forest birds using novel approaches for VHF tracking of vertebrate communities (Methods Ecol. Evol. 2023)."
  },
  {
    "objectID": "publications/index.html",
    "href": "publications/index.html",
    "title": "Scientific Publications",
    "section": "",
    "text": "You can also find my papers on Google Scholar, my ORCID page or on HAL."
  },
  {
    "objectID": "publications/index.html#preprints-3",
    "href": "publications/index.html#preprints-3",
    "title": "Scientific Publications",
    "section": "Preprints (3)",
    "text": "Preprints (3)\n\n\n\n\n\n\n\n  \n\n\n\nNo matching items\n\n\n\n\n\n\n\n\n\n  \n    \n      The promise of community-driven preprints in ecology and evolution \n      \n      \n      \n      \n        \n          2021. Daniel WA Noble, Zoe A Xirocostas, Nicholas C Wu, April Robin Martinig, Rafaela A Almeida, Kevin R Bairos-Novak, Heikel Balti, Michael G Bertram, Louis Bliard, Jack A Brand, Ilha Byrne, Ying-Chi Chan, Dena J Clink, Quentin Corbel, Ricardo A Correia, Jordann Crawford-Ash, Antica Culina, Elvira D'Bastiani, Gideon D Gywa, Melina de Souza Leite, Félicie Dhellemmes, Shreya Dimri, Szymon M Drobniak, Alexander D Elsy, Susan E Everingham, Samuel JL Gascoigne, Matthew Grainger, Gavin C Hossack, Knut A Hovstad, Ed R Ivimey-Cook, Matt Lloyd Jones, Ineta Kačergytė, Georg Küstner, Dalton C Leibold, Magdalena M Mair, Jake M Martin, Ayumi Mizuno, Ian R Moodie, David Moreau, Rose E O'Dea, James A Orr, Matthieu Paquet, Rabindra Parajuli, Joel L Pick, Patrice Pottier, Marija Purgar, Pablo Recio, Dominique G Roche, Raphaël Royauté, Saeed S Sabet, Julio MG Segovia, Inês Silva, Alfredo Sánchez-Tójar, Bruno E Soares, Birgit Szabo, Elina Takola, Eli Thoré, Bishnu Timilsina, Natalie E van Dis, Wilco CEP Verberk, Stefan JG Vriend, Kristoffer H Wild, Coralie Williams, Yefeng Yang, Shinichi Nakagawa, Malgorzata Lagisz. .\n        \n      \n      \n      \n      \n      \n      \n\n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           GitHub \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Sex-specific behavioral syndromes allow the independent evolution of behavioral dimorphism \n      \n      \n      \n      \n        \n          2021. Raphaël Royauté, Anne V Hedrick, Ned A Dochtermann. .\n        \n      \n      \n      \n      \n      \n      \n\n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n      \n      \n         \n           OSF \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Integration of intra-and inter-sexual selection signaling \n      \n      \n      \n      \n        \n          2020. Courtney R Garrison, Raphaël Royauté, Ned A Dochtermann. .\n        \n      \n      \n      \n      \n      \n      \n\n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n\n\n\nNo matching items"
  },
  {
    "objectID": "publications/index.html#published-articles-23",
    "href": "publications/index.html#published-articles-23",
    "title": "Scientific Publications",
    "section": "Published Articles (23)",
    "text": "Published Articles (23)\n\n\n\n\n\n\n\n  \n    \n      Individual flexibility in group foraging behaviour of reef manta rays (Mobula alfredi) \n      \n      \n      \n      \n      \n      \n      \n        \n          2024. Annie Murray, Raphaël Royauté, Guy M. W. Stevens, Callum Roberts, Kathryn E. Arnold. Behavioral Ecology and Sociobiology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           GitHub \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Drift on holey landscapes as a dominant evolutionary process \n      \n      \n      \n      \n      \n      \n      \n        \n          2023. Ned A Dochtermann, Brady Klock, Derek A Roff, Raphaël Royauté. Proceedings of the National Academy of Sciences.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           GitHub \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Nature 4.0: A networked sensor system for integrated biodiversity monitoring \n      \n      \n      \n      \n      \n      \n      \n        \n          2023. Dirk Zeuss, Lisa Bald, Jannis Gottwald, Marcel Becker, Hicham Bellafkir, Jörg Bendix, Phillip Bengel, Larissa T. Beumer, Roland Brandl, Martin Brändle, Stephan Dahlke, Nina Farwig, Bernd Freisleben, Nicolas Friess, Lea Heidrich, Sven Heue, Jonas Höchst, Hajo Holzmann, Patrick Lampe, Martin Leberecht, Kim Lindner, Juan F. Masello, Jonas Mielke Möglich, Markus  Mühling, Thomas Müller, Alexey Noskov, Lars Opgenoorth, Carina Peter, Petra Quillfeldt, Sascha Rösner, Raphaël Royauté, Christian M. Runge, Dana Schabo, Daniel Schneider, Bernhard Seeger, Elliot Shayle, Ralf Steinmetz, Pavel Tafo, Markus Vogelbacher, Stephan Wöllauer, Sohaib Younis, Julian Zobe, Thomas Nauss. Global Change Biology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Implementing Code Review in the Scientific Workflow: Insights from Ecology and Evolutionary Biology \n      \n      \n      \n      \n      \n      \n      \n        \n          2023. Edward Richard Ivimey-Cook, Joel L Pick, Kevin Bairos-Novak, Antica Culina, Elliot Gould, Matthew Grainger, Benjamin Marshall, David Moreau, Matthieu Paquet, Raphaël Royauté, Alfredo Sanchez-Tojar, Inês Silva, Saras Windecker. Journal of Evolutionary Biology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Fencing amplifies individual differences in movement with implications on survival for two migratory ungulates \n      \n      \n      \n      \n      \n      \n      \n        \n          2023. Wenjing Xu, Laura C Gigliotti, Raphaël Royauté, Hall Sawyer, Arthur D. Middleton. Journal of Animal Ecology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Classifying the activity states of small vertebrates using automated VHF telemetry \n      \n      \n      \n      \n      \n      \n      \n        \n          2023. Jannis Gottwald, Raphaël Royauté, Marcel Becker, Tobias Geitz, Jonas Höchst, Patrick Lampe, Lea Leister, Kim Lindner, Julia Maier, Sascha Rösner, Dana G Schabo, Bernd Freisleben, Roland Brandl, Thomas Müller, Nina Farwig, Thomas Nauss. Methods in Ecology and Evolution.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n         \n           GitHub \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Moving away from repeatability: a comment on Stuber et al. \n      \n      \n      \n      \n      \n      \n      \n        \n          2022. Niels J Dingemanse, Anne G Hertel,, Raphaël Royauté. Behavioral Ecology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n       Phylogenetic conservation of behavioural variation and behavioural syndromes \n      \n      \n      \n      \n      \n      \n      \n        \n          2022. Jeremy Dalos,, Raphaël Royauté, Ann V Hedrick, Ned A Dochtermann. Journal of Evolutionary Biology.\n        \n      \n      \n      \n\n      \n         \n           Correction\n         \n      \n      \n      \n      \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n      \n      \n         \n           OSF \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Biologging reveals individual variation in behavioural predictability in the wild \n      \n      \n      \n      \n      \n      \n      \n        \n          2021. Anne G Hertel, Raphaël Royauté, Andreas Zedrosser, Thomas Mueller. Journal of Animal Ecology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           OSF \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Comparing ecological and evolutionary variability within datasets \n      \n      \n      \n      \n      \n      \n      \n        \n          2021. Raphaël Royauté, Ned A Dochtermann. Behavioral Ecology and Sociobiology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n      \n      \n         \n           OSF \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Behavioural syndromes shape evolutionary trajectories via conserved genetic architecture \n      \n      \n      \n      \n      \n      \n      \n        \n          2020. Raphaël Royauté, Anne V Hedrick, Ned A Dochtermann. Proceedings of the Royal Society B.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n         \n           Preprint \n         \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n         \n           GitHub \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      The heritability of behavior: a meta-analysis \n      \n      \n      \n      \n      \n      \n      \n        \n          2019. Ned A Dochtermann, Tori Schwab, Monica A Berdal, Jeremy Dalos, Raphaël Royauté. ]Journal of Heredity.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n         \n           GitHub \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      The mean matters: going beyond repeatability to interpret behavioural variation \n      \n      \n      \n      \n      \n      \n      \n        \n          2019. Ned A Dochtermann, Raphaël Royauté. Animal Behaviour.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Current energy state interacts with the developmental environment to influence behavioural plasticity] \n      \n      \n      \n      \n      \n      \n      \n        \n          2019. Raphaël Royauté, Courtney Garrison, Jeremy Dalos, Monica A Berdal, Ned A Dochtermann. Animal Behaviour.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Paceless life? A meta-analysis of the pace-of-life syndrome hypothesis \n      \n      \n      \n      \n      \n      \n      \n        \n          2018. Raphaël Royauté, Monica A Berdal, Courtney R Garrison, Ned A Dochtermann. Behavioral Ecology and Sociobiology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Phenotypic integration in an extended phenotype: among‐individual variation in nest‐building traits of the alfalfa leafcutting bee (Megachile rotundata) \n      \n      \n      \n      \n      \n      \n      \n        \n          2018. Raphaël Royauté, Elisabeth S Wilson, Bryan R Helm, Rachel E Mallinger, Jarrad Prasifka, Kendra J Greenlee, Julia H Bowsher. Journal of Evolutionary Biology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      When the mean no longer matters: Developmental diet affects behavioral variation but not population averages in the house cricket (Acheta domesticus) \n      \n      \n      \n      \n      \n      \n      \n        \n          2017. Raphaël Royauté, Ned A Dochtermann. Behavioral Ecology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Genetic conservation and management of the California endemic  Torrey pine (*Pinus torreyana* Parry): Implications of genetic rescue in a genetically depauperate species \n      \n      \n      \n      \n      \n      \n      \n        \n          2017. Jill A Hamilton, Raphaël Royauté, Jessica W Wright, Paul Hodgskiss, F Thomas Ledig. ]Ecology and Evolution.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Under the influence: sublethal exposure to an insecticide affects personality expression in a jumping spider \n      \n      \n      \n      \n      \n      \n      \n        \n          2015. Raphaël Royauté, Christopher M Buddle, Charles Vincent. Functional Ecology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n         \n           Data \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Behaviour  metabolism and size: phenotypic modularity or integration in Acheta domesticus? \n      \n      \n      \n      \n      \n      \n      \n        \n          2015. Raphaël Royauté, Kendra Greenlee, Maxwell Baldwin, Ned A Dochtermann.  Animal Behaviour.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Contaminants as a neglected source of behavioural variation \n      \n      \n      \n      \n      \n      \n      \n        \n          2014. Pierre-Olivier Montiglio, Raphaël Royauté. Animal Behaviour.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Interpopulation variations in behavioral syndromes of a jumping spider from insecticide‐treated and insecticide‐free orchards \n      \n      \n      \n      \n      \n      \n      \n        \n          2014. Raphaël Royauté, Christopher M Buddle, Charles Vincent. Ethology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n    \n      Colonization dynamics of agroecosystem spider assemblages after snow-melt in Quebec (Canada) \n      \n      \n      \n      \n      \n      \n      \n        \n          2012. Raphaël Royauté, Christopher M Buddle. Journal of Arachnology.\n        \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n         \n           Publisher's Version \n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n\n\n\nNo matching items"
  },
  {
    "objectID": "publications/index.html#thesis",
    "href": "publications/index.html#thesis",
    "title": "Scientific Publications",
    "section": "Thesis",
    "text": "Thesis\n\n\n\n\n\n\n\n  \n    \n      Factors influencing behavioural variation in apple orchard populations of the jumping spider Eris militaris (Araneae: Salticidae) \n      \n      \n      \n      \n        \n          2014. Raphaël J Royauté. .\n        \n      \n      \n      \n      \n      \n      \n\n      \n      \n      \n      \n      \n         \n           Open Access\n        \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n    \n  \n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Raphaël Royauté",
    "section": "",
    "text": "Behavioral and Evolutionary Ecotoxicology\nI am a behavioral ecologist interested in how animals cope with environmental changes resulting from human activities. I am currently a researcher at the National Research Institute for Agriculture, Food and Environment (INRAE) within the EcoSys research unit and the Sol&Tox team. I focus on how the soil fauna responds to contaminant exposure using a combination of modeling and laboratory experiments. My goal is to develop eco-evolutionary models allowing to understand how soil organisms cope with contaminant exposure and at what costs for soil functions."
  },
  {
    "objectID": "blog/2024/postdoc-call/index.html",
    "href": "blog/2024/postdoc-call/index.html",
    "title": "Postdoctoral Position in Behavioral Ecotoxicology and/or Modeling",
    "section": "",
    "text": "The postdoctoral call from INRAE’s Agroecosystem department is now open. If successful, the department offers a 12-month position to start in fall 2025. If you are interested my research activities, feel free to contact me with your CV and a brief summary of project interests. I would like to prioritize projects on behavioral ecotoxicology and / or modeling but am of course open to your suggestions and ideas. The application must be submitted by the end of September, so make sure to contact me before August 25, 2024 (raphael.royaute@inrae.fr)."
  },
  {
    "objectID": "blog/2023/nonlinear-mm/index.html",
    "href": "blog/2023/nonlinear-mm/index.html",
    "title": "Nonlinear mixed-effect models for individual differences in growth",
    "section": "",
    "text": "(Update 18/03/2024: Fixing minor formatting issues)\nLoad libraries\n\nlibrary(tidyverse); library(patchwork); library(tidybayes)\nlibrary(brms); library(marginaleffects); library(viridis)\nlibrary(easystats); library(kableExtra)\n\nSet theme\n\n\nCode\ntheme_set(theme_bw(16))\n\n\nWe’re first going to load all model objects stored in the stan folder to avoid rerunning all those pesky Bayesian computations.\n\n\nCode\n# Make a vector of file paths\nfile_paths &lt;- list.files(path = \"stan/\", \n                         pattern = \"\\\\.rds\", full.names = TRUE)\n\n# Make a vector of file names\nfile_names &lt;-  gsub(pattern = \"\\\\.rds$\", replacement = \"\", \n                    x = basename(file_paths))\n\n# Read all models into a list\nmods_list &lt;- lapply(file_paths, readRDS)\n\n# Assign file names to list elements\nnames(mods_list) &lt;- file_names      \n\n\n\nRationale\nI’ve been working a lot with nonlinear models lately. In many cases across ecology and evolution, trends do not go on forever. Having modeling approaches that can account for boundaries and plateaus is therefore very important in specific situations. In my case I’m generally interested in how contamination exposure affects growth, reproduction and behavior of invertebrates and its consequences on individual fitness. In this post I’m exploring how to use nonlinear mixed effect models of growth to recover individual trajectories using simulated data. I’m mostly using the {brms} package for now as it provides a very user-friendly syntax for fitting these models. The level of complexity I’m dealing with is veering dangerously toward a full STAN implementation, especially when I’ll have to deal with jointly modeling fitness, but that’s a problem for future me!\n\n\nInspiration\nA lot of the code in this document has been taken and adapted from Solomon Kurtz’s work and his translation of Richard McElreath’s Statistical Rethinking book into {brms} syntax. Specifically, the simulation of individual differences is directly inspired from working through Chapter 14 section 1.3. Many thanks to them for putting out all this material in an open format!\n\n\nModel description\nI’m using the model described in Goussen et al. (2013) showing adaptation of C. elegans to Uranium. The model assumes nematodes body-length grows according to the following Gompertz function:\n\\[\nL = L_{inf}\\times e^{ln \\left( \\frac{L_0}{Linf} \\right) \\times e^{-\\alpha t} }\\]\nwhere \\(L_{inf}\\) is the asymptotic body-length, \\(L_0\\) is the body-length at hatching and \\(\\alpha\\) the growth rate.\nPlugging in the values from the paper gives a sigmoid growth curve:\n\n\nCode\n# Store parameters for non-exposed populations\nn_id = 10 # 10 individuals\nobs = seq(0, 126, by = 24) # One observation every day\nLinf = 1370\nL0 = 182\nalpha = 0.028\nt = seq(0,126, by = 1) # measure every h for 126 h \nsigma = 100 # random noise\n\nGomp.fun = function(t, Linf, L0, alpha){\n  Lhat = Linf * exp(log(L0/Linf)*exp(-alpha*t)) # predicted growth\n  return(Lhat)\n}\n\n# Apply equation\nset.seed(42)\ndf = crossing(obs, 1:n_id) %&gt;% \n  mutate(Lhat = Gomp.fun(obs, Linf = Linf, L0 = L0, alpha = alpha)) %&gt;% \n  mutate(L = rnorm(n(), Lhat, sigma))\ndf %&gt;% \n  ggplot(aes(y = L, x = obs)) +\n  geom_point(alpha = .2, size = 2.5) +\n  geom_function(fun = Gomp.fun, \n                     args = list(Linf = Linf, L0 = L0, alpha = alpha),\n                     color = \"red\", size = 1) +\n  ylim(0, 1600) +\n  labs(x = \"Hours since hatching\", y = \"Body-length (mum)\")\n\n\n\n\n\n\n\n\n\n\n\nSimulating individual differences\nWe can use the brms package to make simulations according to some prior distributions for our parameters. We first need to store the values of the growth parameters for each individual\n\nData simulations\nI’m using the same approach as above but now allow individual to have some deviation from the population mean for all parameters: \\(\\mu_i \\sim N(mu + \\text{offset}, \\text{ } \\sigma)\\) where \\(\\mu\\) and \\(\\mu_i\\) are the individual and population mean for a given parameter and the offset is calculated as: \\(\\text{offset} \\sim N(0, \\text{ } \\sigma_i)\\) where \\(\\sigma_i\\) is the among-individual standard deviation for a given parameters. In our simulation, we assume a coefficient of variation 10 % for all parameters such that \\(\\sigma_i = 0.10 \\times \\mu\\)\n\n\n\n\n\n\nNote\n\n\n\nThere are different ways to interpret the \\(L_{inf}\\) parameter. In Goussen et al’ paper, this was assumed to be the maximum body-size for the population. Meaning that with enough time, all individuals will converge toward this value. Most individuals of course will die before that! Here, I am assuming that all individuals have their own maximum size they can reach. This means that two individuals with the same growth rate measured for the same amount of time may still differ in their maximum length.\n\n\n\n\nCode\nn_id = 30 # 30 individuals\ntimes = seq(0, 126, by = 24) # One observation every day\nsd = 10 # random noise\nL0_mu = 182 # initial length (micrometers)\nLinf_mu = 1370 # maximal length (micrometers)\nalpha_mu = 0.028 # Growth rate (hour^-1)\n\nrho = 0 # Suppose all parameters are independent\n\nmu     = c(L0_mu, Linf_mu, alpha_mu)\nsigmas = c(L0_mu*.1, Linf_mu*.1, alpha_mu*.1) # 10 % CV around the mean\nrho_mat = matrix(c(1, rho, rho,\n                    rho, 1, rho,\n                    rho, rho, 1), \n                    nrow = 3)\n\nsigma = diag(sigmas) %*% rho_mat %*% diag(sigmas)\n\nset.seed(42)\nID = MASS::mvrnorm(n_id, mu, sigma) %&gt;% \n  data.frame() %&gt;% \n  set_names(\"L0_i\", \"Linf_i\", \"alpha_i\") %&gt;% \n  mutate(ID = 1:n_id)\n\n# Simulate individual growth\ndf = ID %&gt;%\n  tidyr::expand(nesting(ID, L0_i, Linf_i, alpha_i), \n                t = times) %&gt;%\n  mutate(Lhat = Linf_i * exp(log(L0_i/Linf_i)*exp(-alpha_i*t))) %&gt;%\n  mutate(L = rnorm(n(), Lhat, sd))\n\nfig.title = df %&gt;% \n  ggplot(aes(y = L, x = t, group = ID)) +\n  geom_point(alpha = .2, size = 2.5) +\n  geom_line(alpha = .2, size = .5) +\n  geom_function(fun = Gomp.fun, \n                     args = list(Linf = Linf, L0 = L0, alpha = alpha),\n                     color = \"red\", size = 1) +\n  ylim(0, 1600) +\n  labs(x = \"Hours since hatching\", \n       y = expression(paste(\"Body-length (\", mu, \"m)\")))\nfig.title\n\n\n\n\n\n\n\n\n\n\n\nDefining the model in brms\nIn brms, we can use the standard R formula syntax to specify the Gompertz model\n\n\nCode\nbf = bf(L ~ \n           Linf * exp(log(L0 / Linf) * exp(-alpha * t)), # Gompertz population curve\n         L0 + Linf + alpha ~ 1 + (1|ID), # parameters with random effects\n         nl = T)\npriors = get_prior(bf, df)\npriors %&gt;% kable(digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nprior\nclass\ncoef\ngroup\nresp\ndpar\nnlpar\nlb\nub\nsource\n\n\n\n\nstudent_t(3, 0, 521.9)\nsigma\n\n\n\n\n\n0\n\ndefault\n\n\n\nb\n\n\n\n\nalpha\n\n\ndefault\n\n\n\nb\nIntercept\n\n\n\nalpha\n\n\ndefault\n\n\nstudent_t(3, 0, 521.9)\nsd\n\n\n\n\nalpha\n0\n\ndefault\n\n\n\nsd\n\nID\n\n\nalpha\n\n\ndefault\n\n\n\nsd\nIntercept\nID\n\n\nalpha\n\n\ndefault\n\n\n\nb\n\n\n\n\nL0\n\n\ndefault\n\n\n\nb\nIntercept\n\n\n\nL0\n\n\ndefault\n\n\nstudent_t(3, 0, 521.9)\nsd\n\n\n\n\nL0\n0\n\ndefault\n\n\n\nsd\n\nID\n\n\nL0\n\n\ndefault\n\n\n\nsd\nIntercept\nID\n\n\nL0\n\n\ndefault\n\n\n\nb\n\n\n\n\nLinf\n\n\ndefault\n\n\n\nb\nIntercept\n\n\n\nLinf\n\n\ndefault\n\n\nstudent_t(3, 0, 521.9)\nsd\n\n\n\n\nLinf\n0\n\ndefault\n\n\n\nsd\n\nID\n\n\nLinf\n\n\ndefault\n\n\n\nsd\nIntercept\nID\n\n\nLinf\n\n\ndefault\n\n\n\n\n\nThese are default priors and may not be well-suited for our problem. For some reason, brms won’t let us sample from these default priors, but we can easily illustrate the point by setting unrealistically uninformative priors (i.e. normal(0, 100) here) on these parameters. I’m using the lower bound argument lb = 0 to keep the growth positive.\n\n\nCode\npriors = priors = \n  # Intercept priors\n  prior(normal(0, 100), nlpar = L0, class = b, lb = 0) +\n  prior(normal(0, 100), nlpar = Linf, class = b, lb = 0) +\n  prior(normal(0, 100), nlpar = alpha, class = b, lb = 0)\n\n\nNext, we fit the model and simply specify sample_prior = \"only\" in the brm() function to only get the growth trends implied by the priors\n\n\nCode\n# plotting\nplot(conditional_effects(mods_list$gomp.prior.default, \n                         ndraws = 100, spaghetti = T))\n\n\n\n\n\n\n\n\n\nNot very good right?! Let’s retry now with more reasonable priors\n\n\nCode\npriors = \n  # Intercept priors\n  prior(normal(200, 40), nlpar = L0, class = b, lb = 0) +\n  prior(normal(1500, 300), nlpar = Linf, class = b, lb = 0) +\n  prior(normal(.03,.006), nlpar = alpha, class = b, lb = 0) + \n  # Random effects priors (informative priors with 20 % CV)\n  prior(exponential(.025), nlpar = L0, class = sd, group = ID) +\n  prior(exponential(.003), nlpar = Linf, class = sd, group = ID) +\n  prior(exponential(170), nlpar = alpha, class = sd, group = ID) +\n  # Residual prior\n  prior(exponential(1), class = sigma) \n\n# Plot priors\np1 = priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Intercepts\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n\np2 = priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Among-individual variance\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n\np3 = priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sigma\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Residual variance\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n \n(p1 + p2 + p3) + plot_layout(ncol = 1)\n\n\n\n\n\n\n\n\n\n\n\nPrior predictive checks\nWe can now check if the model shows a more appropriate gortwh curve while sampling only from these new priors.\nInspecting the model and plotting predicted growth\n\n\nCode\nmods_list$gomp.prior\n\n\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: L ~ Linf * exp(log(L0/Linf) * exp(-alpha * t)) \n         L0 ~ 1 + (1 | ID)\n         Linf ~ 1 + (1 | ID)\n         alpha ~ 1 + (1 | ID)\n   Data: df (Number of observations: 180) \n  Draws: 4 chains, each with iter = 1000; warmup = 500; thin = 1;\n         total post-warmup draws = 2000\n\nMultilevel Hyperparameters:\n~ID (Number of levels: 30) \n                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsd(L0_Intercept)       40.67     42.23     1.14   156.94 1.00     2507     1141\nsd(Linf_Intercept)    332.87    334.35     8.69  1223.07 1.00     2706      955\nsd(alpha_Intercept)     0.01      0.01     0.00     0.02 1.00     2892     1169\n\nRegression Coefficients:\n                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nL0_Intercept      198.73     41.39   120.14   281.26 1.00     3330     1271\nLinf_Intercept   1492.43    311.92   885.14  2091.52 1.00     3261     1357\nalpha_Intercept     0.03      0.01     0.02     0.04 1.00     3684     1428\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     1.03      1.00     0.04     3.46 1.00     2297     1327\n\nDraws were sampled using sample(hmc). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n\n\nCode\nplot(conditional_effects(mods_list$gomp.prior, \n                         ndraws = 100, spaghetti = T))\n\n\n\n\n\n\n\n\n\nCode\nre = crossing(t = seq(min(df$t), \n                       max(df$t),\n                       length.out=100),\n               ID = unique(df$ID)) %&gt;% \n  add_epred_draws(mods_list$gomp.prior, re_formula = NULL, \n                  scale = \"response\", ndraws = 20)\n\nre %&gt;% \n  ggplot(aes(y = .epred, x = t)) +\n  geom_line(aes(y = .epred, x = t, group = .draw), size = .5, alpha = .5) +\n  geom_point(data = df, aes(y=L, x=t, color = ID)) +\n  facet_wrap(~ID, nrow = 6, ncol = 5) + \n  scale_color_viridis() +\n  ylab(\"Mass (mg)\") + \n  xlab(\"Time\") +\n  theme_bw(12) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\nFit model to simulated data\nNext, we can fit the model to the simulated dataset\nInspecting the model and plotting predicted growth\n\n\nCode\nmodel_parameters(mods_list$gomp, effects = \"all\") %&gt;% \n  kable(digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\nEffects\nComponent\nMedian\nCI\nCI_low\nCI_high\npd\nRhat\nESS\nGroup\n\n\n\n\nb_L0_Intercept\nfixed\nconditional\n179.45\n0.95\n170.68\n453.99\n1\n16.77\n2.01\n\n\n\nb_Linf_Intercept\nfixed\nconditional\n1362.79\n0.95\n0.08\n1434.54\n1\n23.18\n2.00\n\n\n\nb_alpha_Intercept\nfixed\nconditional\n0.03\n0.95\n0.00\n0.03\n1\n32.25\n2.00\n\n\n\nsd_ID__L0_Intercept\nrandom\nconditional\n18.31\n0.95\n1.50\n27.59\n1\n1.23\n6.34\nID\n\n\nsd_ID__Linf_Intercept\nrandom\nconditional\n156.11\n0.95\n0.01\n215.75\n1\n3.98\n2.12\nID\n\n\nsd_ID__alpha_Intercept\nrandom\nconditional\n0.00\n0.95\n0.00\n0.00\n1\n1.51\n3.46\nID\n\n\nsigma\nfixed\nsigma\n9.75\n0.95\n8.36\n139.79\n1\n20.58\n2.01\n\n\n\n\n\n\nCode\npp_check(mods_list$gomp, ndraws = 100)\n\n\n\n\n\n\n\n\n\nCode\nplot(conditional_effects(mods_list$gomp, ndraws = 100, spaghetti = T))\n\n\n\n\n\n\n\n\n\nCode\nre = crossing(t = seq(min(df$t), \n                       max(df$t),\n                       length.out=100),\n               ID = unique(df$ID)) %&gt;% \n  add_epred_draws(mods_list$gomp, re_formula = NULL, \n                  scale = \"response\", ndraws = 20)\n\nre %&gt;% \n  ggplot(aes(y = .epred, x = t)) +\n  geom_line(aes(y = .epred, x = t, group = .draw), size = .5, alpha = .5) +\n  geom_point(data = df, aes(y=L, x=t, color = ID)) +\n  facet_wrap(~ID, nrow = 6, ncol = 5) + \n  scale_color_viridis() +\n  ylab(\"Mass (mg)\") + \n  xlab(\"Time\") +\n  theme_bw(12) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\nThe model functions correctly but there are a lot of divergent transitions and some poor convergence diagnostics. Let’s try reparametrizing to improve the sampling.\n\n\nModel reparametrization\nWe can express all body-length parameters as a function of the maximum length to help the model converge. Divinding each side of the Gompertz equation gives\n\\[\\begin{aligned}\nl &= L/L_{inf}\\\\\nl_0 &=L_0/L_{inf}\\\\\nl &= e^{ln \\left( l_0 \\right) \\times e^{-\\alpha t} }\n\\end{aligned}\\]\n\n\nCode\nggplot() +\n  geom_function(fun = Gomp.fun, \n                     args = list(Linf = 1, L0 = L0/Linf, alpha = alpha),\n                     color = \"red\", size = 1) +\n  xlim(0, 126) + ylim(0, 1) +\n  labs(x = \"Hours since hatching\", y = \"Scaled body-length\") \n\n\n\n\n\n\n\n\n\n\nPrior predictive checks\nWe need to reformulate model formula and priors in order to get sensible outputs\n\n\nCode\ndf$l = with(df, L/Linf)\n\nbf = bf(l ~ \n           exp(log(l0) * exp(-alpha * t)), # Gompertz population curve\n         l0 + alpha ~ 1 + (1|ID), # parameters with random effects\n         nl = T)\n\n\nDefining and plotting priors\n\n\nCode\npriors = \n  # Intercept priors\n  prior(normal(.15, .03), nlpar = l0, class = b, lb = 0) +\n  prior(normal(.03,.006), nlpar = alpha, class = b, lb = 0) + \n  # Random effects priors (informative priors with 20 % CV)\n  prior(exponential(34), nlpar = l0, class = sd, group = ID) +\n  prior(exponential(170), nlpar = alpha, class = sd, group = ID) +\n  # Residual prior\n  prior(exponential(1), class = sigma) \n\n# Plot priors\np1 = priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"b\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Intercepts\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n\np2 = priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sd\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Among-individual variance\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n\np3 = priors %&gt;% \n  parse_dist() %&gt;% \n  filter(class == \"sigma\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Residual variance\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n \n(p1 + p2 + p3) + plot_layout(ncol = 1)\n\n\n\n\n\n\n\n\n\nAnd now running the model on priors only\nModel inspection\n\n\nCode\nmodel_parameters(mods_list$gomp.sc.prior, effects = \"all\") %&gt;%\n  kable(digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\nEffects\nComponent\nMedian\nCI\nCI_low\nCI_high\npd\nRhat\nESS\nGroup\n\n\n\n\nb_l0_Intercept\nfixed\nconditional\n0.15\n0.95\n0.09\n0.20\n1\n1\n2769.57\n\n\n\nb_alpha_Intercept\nfixed\nconditional\n0.03\n0.95\n0.02\n0.04\n1\n1\n2270.10\n\n\n\nsd_ID__l0_Intercept\nrandom\nconditional\n0.02\n0.95\n0.00\n0.12\n1\n1\n2925.44\nID\n\n\nsd_ID__alpha_Intercept\nrandom\nconditional\n0.00\n0.95\n0.00\n0.02\n1\n1\n2850.84\nID\n\n\nsigma\nfixed\nsigma\n0.69\n0.95\n0.02\n3.91\n1\n1\n2914.29\n\n\n\n\n\n\nCode\nplot(conditional_effects(mods_list$gomp.sc.prior, \n                         ndraws = 100, spaghetti = T))\n\n\n\n\n\n\n\n\n\nCode\nre = crossing(t = seq(min(df$t), \n                       max(df$t),\n                       length.out=100),\n               ID = unique(df$ID)) %&gt;% \n  add_epred_draws(mods_list$gomp.sc.prior, re_formula = NULL, \n                  scale = \"response\", ndraws = 20)\n\nre %&gt;% \n  ggplot(aes(y = .epred, x = t)) +\n  geom_line(aes(y = .epred, x = t, group = .draw), size = .5, alpha = .5) +\n  geom_point(data = df, aes(y=l, x=t, color = ID)) +\n  facet_wrap(~ID, nrow = 6, ncol = 5) + \n  scale_color_viridis() +\n  ylab(\"Mass (mg)\") + \n  xlab(\"Time\") +\n  theme_bw(12) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\nFitting model to data\nAs above we rerun the scaled model on the scaled data\nModel inspection\n\n\nCode\nmodel_parameters(mods_list$gomp.sc, effects = \"all\") %&gt;%\n  kable(digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\nEffects\nComponent\nMedian\nCI\nCI_low\nCI_high\npd\nRhat\nESS\nGroup\n\n\n\n\nb_l0_Intercept\nfixed\nconditional\n0.13\n0.95\n0.12\n0.14\n1\n1.00\n4283.00\n\n\n\nb_alpha_Intercept\nfixed\nconditional\n0.03\n0.95\n0.03\n0.03\n1\n1.00\n657.83\n\n\n\nsd_ID__l0_Intercept\nrandom\nconditional\n0.01\n0.95\n0.00\n0.02\n1\n1.01\n989.17\nID\n\n\nsd_ID__alpha_Intercept\nrandom\nconditional\n0.01\n0.95\n0.00\n0.01\n1\n1.00\n733.22\nID\n\n\nsigma\nfixed\nsigma\n0.04\n0.95\n0.03\n0.04\n1\n1.00\n3774.40\n\n\n\n\n\n\nCode\nplot(conditional_effects(mods_list$gomp.sc, \n                         ndraws = 100, spaghetti = T))\n\n\n\n\n\n\n\n\n\nCode\npp_check(mods_list$gomp.sc, ndraws = 100)\n\n\n\n\n\n\n\n\n\nCode\nre = crossing(t = seq(min(df$t), \n                       max(df$t),\n                       length.out=100),\n               ID = unique(df$ID)) %&gt;% \n  add_epred_draws(mods_list$gomp.sc, re_formula = NULL, \n                  scale = \"response\", ndraws = 20)\n\nre %&gt;% \n  ggplot(aes(y = .epred, x = t)) +\n  geom_line(aes(y = .epred, x = t, group = .draw), size = .5, alpha = .5) +\n  geom_point(data = df, aes(y=l, x=t, color = ID)) +\n  facet_wrap(~ID, nrow = 6, ncol = 5) + \n  scale_color_viridis() +\n  ylab(\"Mass (mg)\") + \n  xlab(\"Time\") +\n  theme_bw(12) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\nMuch better!\n\n\n\n\nAssuming a trade-off between maximum size and growth-rate\nSo far, we have assumed that all our parameters are independent. However, trade-offs between various life-history traits are also likely to occur. One such trade-off is the compromise between fast growth and reproductive rate, such that individuals that mature sooner reach a smaller asymptotic length. This is the case in collembolas exposed to Cadmium for example. We can easily modify our simulation function to incorporate a similar trade-off in our data.\n\nData simulations and modeling\n\n\nCode\nn_id = 30 # 30 individuals\ntimes = seq(0, 126, by = 24) # One observation every day\nsd = 10 # random noise\nL0_mu = 182 # initial length (micrometers)\nLinf_mu = 1370 # maximal length (micrometers)\nalpha_mu = 0.028 # Growth rate (hour^-1)\n\nrho = -.7 # Assume strong negative correlation between Linf and alpha\n\nmu     = c(L0_mu, Linf_mu, alpha_mu)\nsigmas = c(L0_mu*.1, Linf_mu*.1, alpha_mu*.1) # 10 % CV around the mean\nrho_mat = matrix(c(1, 0, 0,\n                    0, 1, rho,\n                    0, rho, 1), \n                    nrow = 3)\n\nsigma = diag(sigmas) %*% rho_mat %*% diag(sigmas)\n\nset.seed(42)\nID = MASS::mvrnorm(n_id, mu, sigma) %&gt;% \n  data.frame() %&gt;% \n  set_names(\"L0_i\", \"Linf_i\", \"alpha_i\") %&gt;% \n  mutate(ID = 1:n_id)\n\n# Plot\nID %&gt;% \n  select(-ID) %&gt;% \n  GGally::ggpairs() +\n  theme_bw() \n\n\n\n\n\n\n\n\n\nAnd now we simulate growth over 126 hours as before\n\n\nCode\n# Simulate individual growth\ndf = ID %&gt;%\n  tidyr::expand(nesting(ID, L0_i, Linf_i, alpha_i), \n                t = times) %&gt;%\n  mutate(Lhat = Linf_i * exp(log(L0_i/Linf_i)*exp(-alpha_i*t))) %&gt;%\n  mutate(L = rnorm(n(), Lhat, sd))\n\ndf %&gt;% \n  ggplot(aes(y = L, x = t, group = ID)) +\n  geom_point(alpha = .2, size = 2.5) +\n  geom_line(alpha = .2, size = .5) +\n  geom_function(fun = Gomp.fun, \n                     args = list(Linf = Linf_mu, L0 = L0_mu, alpha = alpha_mu),\n                     color = \"red\", size = 1) +\n  ylim(0, 1600) +\n  labs(x = \"Hours since hatching\", y = \"Body-length (mum)\")\n\n\n\n\n\n\n\n\n\nSwitching directly to fitting the model to the data, we make some small adjustments to the formula\n\n\nCode\ndf$l = with(df, L/Linf_mu)\n\nbf = bf(l ~ \n           linf*exp(log(l0/linf) * exp(-alpha * t)), # Gompertz population curve\n         l0 + linf + alpha ~ 1 + (1|c|ID), # parameters with random effects\n         nl = T)\n\n\nWe introduce a scaled version of \\(L_{inf}\\) into the formula and allow random effects to be correlated with the (1|c|ID) chunk. Next we need to specify a strong prior for on \\(l_{inf}\\) to constrain it around 1. We also specify a prior on the correlation parameter using an LKJ prior of parameter \\(\\eta&gt;1\\)\n\n\nCode\npriors = \n  # Intercept priors\n  prior(normal(.15, .03), nlpar = l0, class = b, lb = 0) +\n  prior(normal(1, .03), nlpar = linf, class = b, lb = 0) +\n  prior(normal(.03,.006), nlpar = alpha, class = b, lb = 0) + \n  # Random effects priors (informative priors with 20 % CV)\n  prior(exponential(34), nlpar = l0, class = sd, group = ID) +\n  prior(exponential(5), nlpar = linf, class = sd, group = ID) +\n  prior(exponential(170), nlpar = alpha, class = sd, group = ID) +\n  # Residual prior\n  prior(exponential(1), class = sigma) +\n  # Correlation prior\n  prior(lkj(2), class = cor)\n\n\n# Plot priors for linf\npriors %&gt;% \n  parse_dist() %&gt;% \n  filter(nlpar == \"linf\") %&gt;% \n  ggplot(aes(xdist = .dist_obj, y = format(.dist_obj))) +\n  stat_dist_halfeye() +\n  facet_wrap(~nlpar, scales = \"free\") +\n  ggtitle(\"Scaled asymptotic length priors\") +\n  xlab(\"Value\") + ylab(\"Density\") +\n  theme_bw(12) +\n  theme(axis.text.y = element_text(angle = 90)) \n\n\n\n\n\n\n\n\n\nTo get a better sense of what these prior imply, we can simulate the distribution of individual differences in \\(l_{inf}\\)\n\n\nCode\nlinf_sim = data.frame(offsets = rnorm(n_id*100, 0, .2)) %&gt;% \n  mutate(linf_mu = rnorm(n(), (1 + offsets), sigma))\n  \nlinf_sim %&gt;% \n  ggplot(aes(x = linf_mu)) +\n  stat_halfeye() +\n  xlim(-2,3)\n\n\n\n\n\n\n\n\n\nWe now fit the model to the simulated data\n\n\nModel inspection\n\n\nCode\nmodel_parameters(mods_list$gomp.to, effects = \"all\") %&gt;%\n  kable(digits = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nParameter\nEffects\nComponent\nMedian\nCI\nCI_low\nCI_high\npd\nRhat\nESS\nGroup\n\n\n\n\nb_l0_Intercept\nfixed\nconditional\n0.13\n0.95\n0.12\n0.14\n1.00\n1\n2221.01\n\n\n\nb_linf_Intercept\nfixed\nconditional\n1.00\n0.95\n0.97\n1.04\n1.00\n1\n1853.79\n\n\n\nb_alpha_Intercept\nfixed\nconditional\n0.03\n0.95\n0.03\n0.03\n1.00\n1\n1865.96\n\n\n\nsd_ID__l0_Intercept\nrandom\nconditional\n0.01\n0.95\n0.01\n0.02\n1.00\n1\n2073.78\nID\n\n\nsd_ID__linf_Intercept\nrandom\nconditional\n0.12\n0.95\n0.09\n0.15\n1.00\n1\n1506.85\nID\n\n\nsd_ID__alpha_Intercept\nrandom\nconditional\n0.00\n0.95\n0.00\n0.00\n1.00\n1\n1640.96\nID\n\n\ncor_ID__l0_Intercept__linf_Intercept\nrandom\nconditional\n-0.33\n0.95\n-0.62\n0.02\n0.97\n1\n1003.81\nID\n\n\ncor_ID__l0_Intercept__alpha_Intercept\nrandom\nconditional\n0.07\n0.95\n-0.30\n0.43\n0.64\n1\n1036.33\nID\n\n\ncor_ID__linf_Intercept__alpha_Intercept\nrandom\nconditional\n-0.72\n0.95\n-0.86\n-0.46\n1.00\n1\n3286.74\nID\n\n\nsigma\nfixed\nsigma\n0.01\n0.95\n0.01\n0.01\n1.00\n1\n1478.80\n\n\n\n\n\n\nCode\nplot(conditional_effects(mods_list$gomp.to, \n                         ndraws = 100, spaghetti = T))\n\n\n\n\n\n\n\n\n\nCode\npp_check(mods_list$gomp.to, ndraws = 100)\n\n\n\n\n\n\n\n\n\nCode\nre = crossing(t = seq(min(df$t), \n                       max(df$t),\n                       length.out=100),\n               ID = unique(df$ID)) %&gt;% \n  add_epred_draws(mods_list$gomp.to, re_formula = NULL,\n                  scale = \"response\", ndraws = 20)\n\nre %&gt;% \n  ggplot(aes(y = .epred, x = t)) +\n  geom_line(aes(y = .epred, x = t, group = .draw), size = .5, alpha = .5) +\n  geom_point(data = df, aes(y=l, x=t, color = ID)) +\n  facet_wrap(~ID, nrow = 6, ncol = 5) + \n  scale_color_viridis() +\n  ylab(\"Mass (mg)\") + \n  xlab(\"Time\") +\n  theme_bw(12) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\nThis recovers the parameter values pretty well! Note that there is some moderate correlation between \\(l_0\\) and \\(l_{inf}\\) due to sampling even if the true value is 0. The model seems to overestimate slightly this value compared to the value found in the simulated data. Let’s now plot these correlations according to the model estimates\n\n\nCode\nre = mods_list$gomp.to %&gt;%\n  spread_draws(# Population values\n    b_l0_Intercept, b_linf_Intercept, b_alpha_Intercept, \n    # Individual offsets\n    r_ID__l0[ID,Intercept], r_ID__linf[ID,Intercept], r_ID__alpha[ID,Intercept],\n    # Individual variances\n    sd_ID__l0_Intercept, sd_ID__linf_Intercept, sd_ID__alpha_Intercept,\n    sigma) %&gt;% \n  # Individual offsets converted onto the original length scale (in micrometers)\n  mutate(L0_i = (b_l0_Intercept + r_ID__l0) * Linf_mu,\n         Linf_i = (b_linf_Intercept + r_ID__linf) * Linf_mu,\n         alpha_i = b_alpha_Intercept + r_ID__alpha) %&gt;% \n  # Population averge distribution\n  mutate(L0_dist = rnorm(n(), b_l0_Intercept, sd_ID__l0_Intercept)*Linf_mu,\n         Linf_dist = rnorm(n(), b_linf_Intercept, sd_ID__linf_Intercept)*Linf_mu,\n         alpha_dist = rnorm(n(), b_alpha_Intercept, sd_ID__alpha_Intercept))\nre.mean = re %&gt;% \n  select(.chain, .iteration, .draw, L0_i, Linf_i, alpha_i) %&gt;% \n   mean_qi(L0_i, Linf_i, alpha_i)\n  # Summarize individual values into mean, lower and upper 95 % quantiles\n\n# Plot population average (diagonal elements)\nL0_dist = re %&gt;% \n  ggplot(aes(x = L0_dist)) +\n  stat_histinterval(slab_color = \"gray45\", \n                    outline_bars = TRUE) +\n  labs(x = \"\", y = expression(L[0])) +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\nLinf_dist = re %&gt;% \n  ggplot(aes(x = Linf_dist)) +\n  stat_histinterval(slab_color = \"gray45\", \n                    outline_bars = TRUE) +\n  labs(x = \"\", y = \"\") +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\nalpha_dist = re %&gt;% \n  ggplot(aes(x = alpha_dist)) +\n  stat_histinterval(slab_color = \"gray45\", \n                    outline_bars = TRUE) +\n  labs(x = expression(alpha), y = \"\") +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\n\n# Plot individual average with CI (lower diagonal elements)\ncorr1 = re.mean %&gt;% \n  ggplot(aes(x = L0_i, y = Linf_i)) +\n  geom_errorbarh(aes(xmin = L0_i.lower, xmax = L0_i.upper)) +\n  geom_errorbar(aes(ymin = Linf_i.lower, ymax = Linf_i.upper)) +\n  geom_point(alpha = .8, size = 3) +\n  labs(x = \"\", y = expression(L[inf])) +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\ncorr2 = re.mean %&gt;% \n  ggplot(aes(x = L0_i, y = alpha_i)) +\n  geom_errorbarh(aes(xmin = L0_i.lower, xmax = L0_i.upper)) +\n  geom_errorbar(aes(ymin = alpha_i.lower, ymax = alpha_i.upper)) +\n  geom_point(alpha = .8, size = 3) +\n  labs(x = expression(L[0]), y = expression(alpha)) +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\ncorr3 = re.mean %&gt;% \n  ggplot(aes(x = Linf_i, y = alpha_i)) +\n  geom_errorbarh(aes(xmin = Linf_i.lower, xmax = Linf_i.upper)) +\n  geom_errorbar(aes(ymin = alpha_i.lower, ymax = alpha_i.upper)) +\n  geom_point(alpha = .8, size = 3) +\n  labs(x = expression(L[inf]), y = \"\") +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\n\n# Plot correlation estimate (upper diagonal elements)\ndcorr1 = mods_list$gomp.to %&gt;% \n  spread_draws(`cor.*`, regex = TRUE) %&gt;% \n  ggplot(aes(x = cor_ID__l0_Intercept__linf_Intercept)) +\n  stat_halfeye() +\n  geom_vline(xintercept = 0, linewidth = 1, color = \"black\", linetype = \"dashed\") +\n  xlim(-1, 1) +\n  labs(x = \"\", y = \"\") +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\ndcorr2 = mods_list$gomp.to %&gt;% \n  spread_draws(`cor.*`, regex = TRUE) %&gt;% \n  ggplot(aes(x = cor_ID__l0_Intercept__alpha_Intercept)) +\n  stat_halfeye() +\n  geom_vline(xintercept = 0, linewidth = 1, color = \"black\", linetype = \"dashed\") +\n  xlim(-1, 1) +\n  labs(x = \"\", y = \"\") +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\ndcorr3 = mods_list$gomp.to %&gt;% \n  spread_draws(`cor.*`, regex = TRUE) %&gt;% \n  ggplot(aes(x = cor_ID__linf_Intercept__alpha_Intercept)) +\n  stat_halfeye() +\n  geom_vline(xintercept = 0, linewidth = 1, color = \"black\", linetype = \"dashed\") +\n  xlim(-1, 1) +\n  labs(x = \"\", y = \"\") +\n  theme_bw(12) +\n  theme(aspect.ratio=1)\n\n# Arrange plot into 3 x 3 grid\nL0_dist + dcorr1 + dcorr2 +\n  corr1 + Linf_dist + dcorr3 +\n  corr2 + corr3 + alpha_dist +\n  plot_layout(ncol = 3, nrow = 3, byrow = T)\n\n\n\n\n\n\n\n\n\nAnother possibility is to sample correlation estimates and plot those on a small grid with each color corresponding to the correlation strength. Solution found on Matthew Kay and Solomon Kurtz websites\n\n\nCode\nlevels = c(\"l[0]\", \"l[inf]\", \"alpha\")\n\nrho = as_draws_df(mods_list$gomp.to) %&gt;% \n  select(starts_with(\"cor_\")) %&gt;% \n  slice_sample(n = 60 * 60) %&gt;% \n  bind_cols(crossing(x = 1:60, y = 1:60)) %&gt;% \n  pivot_longer(cols = -c(x:y)) %&gt;% \n  mutate(name = str_remove(name, \"cor_ID__\")) %&gt;% \n  separate(name, into = c(\"col\", \"row\"), sep = \"__\") %&gt;% \n  mutate(\n    col = case_when(\n      col == \"l0_Intercept\"   ~ \"l[0]\",\n      col == \"linf_Intercept\" ~ \"l[inf]\",\n      col == \"alpha_Intercept\" ~ \"alpha\"),\n    row = case_when(\n      row == \"l0_Intercept\"  ~ \"l[0]\",\n      row == \"linf_Intercept\" ~ \"l[inf]\",\n      row == \"alpha_Intercept\" ~ \"alpha\")) %&gt;% \n  mutate(col = factor(col, levels = levels),\n         row = factor(row, levels = levels))\n\nrho %&gt;% \n  full_join(rename(rho, col = row, row = col),\n            by = c(\"x\", \"y\", \"col\", \"row\", \"value\")) %&gt;%\n  \n  ggplot(aes(x = x, y = y, fill = value)) +\n  geom_raster() +\n  scale_fill_distiller(type = \"div\", \n                       palette = \"RdBu\", \n                       limits = c(-1, 1), name = expression(rho)) +\n  # scale_fill_gradient2(expression(rho),\n  #                      low = \"#59708b\", mid = \"#FCF9F0\", high = \"#A65141\", midpoint = 0,\n  #                      labels = c(-1, \"\", 0, \"\", 1), limits = c(-1, 1)) +\n  scale_x_continuous(NULL, breaks = NULL, expand = c(0, 0)) +\n  scale_y_continuous(NULL, breaks = NULL, expand = c(0, 0)) +\n  theme(strip.text = element_text(size = 12)) +\n  facet_grid(row ~ col, labeller = label_parsed, switch = \"y\")\n\n\n\n\n\n\n\n\n\n\n\n\nIn conclusion\n\n\nMathematical description of the statistical models\nFormally, our statistical model can be described with the following set of equations\n\nNon-scaled model\n$$\n\\[\\begin{aligned}\n\n\\large \\text{Model Likelihood}\\\\\n\\text{Average growth rate}\\\\\nL_{i,t} &\\sim N(\\mu_{i,t}, \\text{ } \\sigma)\\\\\n\n\\mu_{i,t} &= L_{inf_{i}}\\times e^{ln \\left( \\frac{L_{0_{i}}}{L_{inf_{i}}} \\right) \\times e^{-\\alpha_i t} } \\\\\n\n\\text{Among-individual covariance}\\\\\n\\begin{bmatrix}\n\\mu_{L_{0_{i}}}\\\\\n\\mu_{L_{inf_{i}}}\\\\\n\\mu_{\\alpha_i}\\\\\n\\end{bmatrix} &\\sim\n\nMVN(\\begin{bmatrix}\n\\mu_{L_{0}}\\\\\n\\mu_{L_{inf}}\\\\\n\\mu_{\\alpha}\\\\\n\\end{bmatrix},\n\\Sigma)\\\\\n\n\\Sigma &=\n\\begin{bmatrix}\n\\sigma_{L_{0_{i}}} & 0 & 0\\\\\n0 & \\sigma_{L_{inf_{i}}} & 0 \\\\\n0 & 0 & \\sigma_{\\alpha_i}\n\\end{bmatrix}\n\nR\n\n\\begin{bmatrix}\n\\sigma_{L_{0_{i}}} & 0 & 0\\\\\n0 & \\sigma_{L_{inf_{i}}} & 0 \\\\\n0 & 0 & \\sigma_{\\alpha_i}\n\\end{bmatrix} \\\\\n\nR &=\n\\begin{bmatrix}\n1 & \\rho_{1,2} & \\rho_{1,3}\\\\\n\\rho_{1,2} & 1 & \\rho_{2,3} \\\\\n\\rho_{1,3} & \\rho_{2,3} & 1\n\\end{bmatrix} \\\\\n\n\\large \\text{Priors}\\\\\n\\text{Population Intercepts}\\\\\n\\mu_{L_{0}} &\\sim N(200, 40) \\\\\n\\mu_{L_{inf}} &\\sim N(1500, 300) \\\\\n\\mu_{\\alpha}  &\\sim N(0.03, 0.006) \\\\\n\n\\text{Among-individual variances}\\\\\n\\sigma_{L_{0_{i}}} &\\sim Exp(.025) \\\\\n\\sigma_{L_{inf_{i}}} &\\sim Exp(.003) \\\\\n\\sigma_{\\alpha_i} &\\sim Exp(170) \\\\\n\\sigma &\\sim Exp(1) \\\\\n\n\\text{Among-individual covariance}\\\\\nR &\\sim LKJ(2)\n\\end{aligned}\\]\n$$\n\n\nScaled model\nCompared to the non-scaled model, the major difference here is that we put a strong prior around 1 for the \\(l_{inf}\\) parameter.\n$$\n\\[\\begin{aligned}\n\n\\large \\text{Model Likelihood}\\\\\n\\text{Average growth rate}\\\\\nl_{i,t} &\\sim N(\\mu_{i,t}, \\text{ } \\sigma)\\\\\n\n\\mu_{i,t} &= l_{inf_{i}}\\times e^{ln \\left( \\frac{l_{0_{i}}}{l_{inf_{i}}} \\right) \\times e^{-\\alpha_i t} } \\\\\n\n\\text{Among-individual covariance}\\\\\n\\begin{bmatrix}\n\\mu_{l_{0_{i}}}\\\\\n\\mu_{l_{inf_{i}}}\\\\\n\\mu_{\\alpha_i}\\\\\n\\end{bmatrix} &\\sim\n\nMVN(\\begin{bmatrix}\n\\mu_{l_{0}}\\\\\n\\mu_{l_{inf}}\\\\\n\\mu_{\\alpha}\\\\\n\\end{bmatrix},\n\\Sigma)\\\\\n\n\\Sigma &=\n\\begin{bmatrix}\n\\sigma_{l_{0_{i}}} & 0 & 0\\\\\n0 & \\sigma_{l_{inf_{i}}} & 0 \\\\\n0 & 0 & \\sigma_{\\alpha_i}\n\\end{bmatrix}\n\nR\n\n\\begin{bmatrix}\n\\sigma_{L_{0_{i}}} & 0 & 0\\\\\n0 & \\sigma_{L_{inf_{i}}} & 0 \\\\\n0 & 0 & \\sigma_{\\alpha_i}\n\\end{bmatrix} \\\\\n\nR &=\n\\begin{bmatrix}\n1 & \\rho_{1,2} & \\rho_{1,3}\\\\\n\\rho_{1,2} & 1 & \\rho_{2,3} \\\\\n\\rho_{1,3} & \\rho_{2,3} & 1\n\\end{bmatrix} \\\\\n\n\\large \\text{Priors}\\\\\n\\text{Population Intercepts}\\\\\n\\mu_{L_{0}} &\\sim N(0.15, 0.03) \\\\\n\\mu_{L_{inf}} &\\sim N(1, 0.3) \\\\\n\\mu_{\\alpha}  &\\sim N(0.03, 0.006) \\\\\n\n\\text{Among-individual variances}\\\\\n\\sigma_{L_{0_{i}}} &\\sim Exp(34) \\\\\n\\sigma_{L_{inf_{i}}} &\\sim Exp(5) \\\\\n\\sigma_{\\alpha_i} &\\sim Exp(170) \\\\\n\\sigma &\\sim Exp(1) \\\\\n\n\\text{Among-individual covariance}\\\\\nR &\\sim LKJ(2)\n\\end{aligned}\\]\n$$\n\n\n\nSession info\n\n\nCode\nsessionInfo()\n\n\nR version 4.3.2 (2023-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Paris\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] kableExtra_1.4.0       see_0.8.2              report_0.5.8          \n [4] parameters_0.21.5      performance_0.10.9     modelbased_0.8.7      \n [7] insight_0.19.8         effectsize_0.8.6       datawizard_0.9.1      \n[10] correlation_0.8.4      bayestestR_0.13.2      easystats_0.7.0       \n[13] viridis_0.6.5          viridisLite_0.4.2      marginaleffects_0.18.0\n[16] brms_2.20.12           Rcpp_1.0.12            tidybayes_3.0.6       \n[19] patchwork_1.2.0        lubridate_1.9.3        forcats_1.0.0         \n[22] stringr_1.5.1          dplyr_1.1.4            purrr_1.0.2           \n[25] readr_2.1.5            tidyr_1.3.1            tibble_3.2.1          \n[28] ggplot2_3.5.0          tidyverse_2.0.0       \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3   tensorA_0.36.2.1     rstudioapi_0.15.0   \n  [4] jsonlite_1.8.8       magrittr_2.0.3       farver_2.1.1        \n  [7] rmarkdown_2.25       ragg_1.2.7           vctrs_0.6.5         \n [10] base64enc_0.1-3      htmltools_0.5.7      distributional_0.4.0\n [13] curl_5.2.0           StanHeaders_2.32.5   htmlwidgets_1.6.4   \n [16] plyr_1.8.9           zoo_1.8-12           igraph_2.0.2        \n [19] mime_0.12            lifecycle_1.0.4      pkgconfig_2.0.3     \n [22] colourpicker_1.3.0   Matrix_1.6-5         R6_2.5.1            \n [25] fastmap_1.1.1        shiny_1.8.0          digest_0.6.34       \n [28] GGally_2.2.1         colorspace_2.1-0     ps_1.7.6            \n [31] textshaping_0.3.7    crosstalk_1.2.1      labeling_0.4.3      \n [34] fansi_1.0.6          timechange_0.3.0     abind_1.4-5         \n [37] compiler_4.3.2       withr_3.0.0          backports_1.4.1     \n [40] inline_0.3.19        shinystan_2.6.0      ggstats_0.5.1       \n [43] QuickJSR_1.1.3       pkgbuild_1.4.3       MASS_7.3-60.0.1     \n [46] gtools_3.9.5         loo_2.7.0            tools_4.3.2         \n [49] httpuv_1.6.14        threejs_0.3.3        glue_1.7.0          \n [52] nlme_3.1-164         promises_1.2.1       grid_4.3.2          \n [55] cmdstanr_0.7.1       checkmate_2.3.1      reshape2_1.4.4      \n [58] generics_0.1.3       gtable_0.3.4         tzdb_0.4.0          \n [61] data.table_1.15.0    hms_1.1.3            xml2_1.3.6          \n [64] utf8_1.2.4           pillar_1.9.0         ggdist_3.3.1        \n [67] markdown_1.12        posterior_1.5.0      later_1.3.2         \n [70] lattice_0.22-5       tidyselect_1.2.0     miniUI_0.1.1.1      \n [73] knitr_1.45           arrayhelpers_1.1-0   gridExtra_2.3       \n [76] V8_4.4.2             svglite_2.1.3        stats4_4.3.2        \n [79] xfun_0.42            bridgesampling_1.1-2 matrixStats_1.2.0   \n [82] DT_0.32              rstan_2.32.5         stringi_1.8.3       \n [85] yaml_2.3.8           evaluate_0.23        codetools_0.2-19    \n [88] cli_3.6.2            RcppParallel_5.1.7   shinythemes_1.2.0   \n [91] xtable_1.8-4         systemfonts_1.0.5    munsell_0.5.0       \n [94] processx_3.8.3       coda_0.19-4.1        svUnit_1.0.6        \n [97] parallel_4.3.2       rstantools_2.4.0     ellipsis_0.3.2      \n[100] dygraphs_1.1.1.6     bayesplot_1.11.1     Brobdingnag_1.2-9   \n[103] mvtnorm_1.2-4        scales_1.3.0         xts_0.13.2          \n[106] rlang_1.1.3          shinyjs_2.1.0"
  },
  {
    "objectID": "people/index.html#principal-investigator",
    "href": "people/index.html#principal-investigator",
    "title": "People",
    "section": "Principal Investigator",
    "text": "Principal Investigator\n\n\n\n\n\n\n\n\n\n\nRaphaël Royauté\nBackground: Behavioral Ecology, Evolutionary Ecology, Ecotoxicology\nPosition: Researcher in Ecotoxicological Modeling\nLinks: INRAE Website, GitHub, GitLab, Email"
  },
  {
    "objectID": "people/index.html#current",
    "href": "people/index.html#current",
    "title": "People",
    "section": "Current",
    "text": "Current\n\n\n\n\n\n\n\n\n\n\n\nLisa Gollot\nLisa has a background in environmental chemistry and agronomy. Within the course of her MSc studies in ecotoxicology at AgroParisTech, she joined our team for a 6-month internship focusing on the modeling of individual differences in earthworm growth under different pesticide exposure regimes. She has started her PhD with us in October 2023 on similar topics.\nBackground: Analytical Chemistry, Ecotoxicology\nProject: Eco-evolutionary dynamics\nCo-supervisors: Rémy Beaudouin (INERIS), Juliette Faburé (EcoSys)"
  },
  {
    "objectID": "people/index.html#technical-staff",
    "href": "people/index.html#technical-staff",
    "title": "People",
    "section": "Technical staff",
    "text": "Technical staff\n\n\n\n\n\n\n\n\n\nAntoine Bamière\nAntoine is an Assistant Engineer in soil fauna and is in charge of arthropod rearing in our research unit. He also assists with fieldwork and experimental projects dedicated to the ecotoxicology of soil organisms.\nLinks: INRAE Website\n\n\n\n\n\n\n\n\n\n\n\n\n\nVéronique Etiévant\nVéronique is Technician in soil fauna and is in charge of is in charge of earthworm rearing in our research unit. She also assists with fieldwork and experimental projects dedicated to the ecotoxicology of soil organisms.\nLinks: INRAE Website"
  },
  {
    "objectID": "people/index.html#past-students",
    "href": "people/index.html#past-students",
    "title": "People",
    "section": "Past students",
    "text": "Past students\n\n\n\n\n\n\n\n\n\n\nAlban Royné\nAlban completed just completed his MSc from Université des Sciences de Bordeaux. He completed his end-of-year project with us and worked on trophic interactions between carabids and detritivores exposed to pesticide mixtures.\nBackground: Ecotoxicology and Environmental Chemistry\nProject: Effect of pesticides in simplified soil trophic networks\nCo-supervisor: Colette Bertrand (EcoSys)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClara Laborczy\nClara is a second-year student at AgroParisTech. She did an internship as part of the “La Recherche & moi” programm, working on an interactive dashboard for monitoring our earthworm laboratory population.\nBackground: Agronomy\nProject: Eco-evolutionary dynamics\nCo-supervisor: Lisa Gollot (EcoSys)\n\n\n\n\n\n\n\n\n\n\n\n\n\nPerrine Legrand\nPerrine came as a first-year MSc student in evolutionary biology at Université de Lille. She focused on developing methods for evaluating the effects of pesticide exposure on soil fauna in a simplified trophic network.\nBackground: Biodiversity, Ecology and Evolution\nProject: Effect of pesticides in simplified soil trophic networks\n\n\n\n\n\n\n\n\n\n\n\n\n\nMagali Dahirel\nMagali completed her MSc. in ecological modeling at Université de Rennes 1. She worked with us on an agent-based model of aphid-ladybeetle dynamics under pesticide exposure.\nBackground: Biodiversity, Ecology and Evolution\nProject: TRAVERSéES\nCo-supervisors: Corinne Robert (EcoSys), Pierre-Antoine Précigout (EcoSys), Colette Bertrand (EcoSys)"
  }
]